openapi: '3.0.3'
info:
  version: '0.9.0-oas3'
  title: OIAP
  description: |
    **Open Info API para Puertos**


    This file contains all the APIs developed for the `Open Info API para Puertos` project for the **Port Calendar Domain** within the initiative Ports 4.0 form Puertos del Estado (ES).

  termsOfService: http://swagger.io/terms/
  license:
    name: CC0 1.0 Universal (CC0 1.0)
    url: https://creativecommons.org/publicdomain/zero/1.0/deed.es
  contact:
    name: OpenInfoAPI github
    url: https://github.com/portdebarcelona/OpenInfoAPI-Ports
tags:
  - name: Port Calendar
    description: "APIs related to the docummentary procedures of a port."
    externalDocs:
      description: Description 
      url: http://swagger.io/ 
servers:
  - url: https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/oasdefinitions
    description: >
        Main server 
paths:
  /holidays:
    get:
      tags:
        - Port Calendar
      summary: Returns a list of holidays in a given period of time of a year and for a given place.
      description: Information about list of public holidays from a requested period of time of a year and a place (country and subdivision).
      parameters:
        - $ref: '#/components/parameters/country'
        - $ref: '#/components/parameters/subdivision'
        - $ref: '#/components/parameters/fromDate' 
        - $ref: '#/components/parameters/toDate'       
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  holidays:
                    type: array
                    items:
                      $ref: '#/components/schemas/holiday'
                  queryParams:
                    type: object
                    properties:
                      country:
                        $ref: './oiapComponents.yml#/components/schemas/countryCode'
                      subdivision:
                        $ref: './oiapComponents.yml#/components/schemas/subdivisionCode'
                      fromDate:
                        $ref: './oiapComponents.yml#/components/schemas/fromDate'
                      toDate:
                        $ref: './oiapComponents.yml#/components/schemas/toDate'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

# Still not used
  /portCalendar:
    get:
      tags:
        - Port Calendar
      summary: Returns a list of working days and openning hours.
      description: >
              Information about working days, weekend days, and list of public holidays from the requested date period and port.
              Possible APIs:
              **Port calendar**: Query about the companies that will work on a specific period of time.
              Request parameters: port name, port UN/LOCODE, name of the company, activity, selected period of time.
              Data included in the response: json with the name of the company, day of the selected period, opening hours on that day.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/activity'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  portCalendar:
                    type: array
                    items:
                      $ref: '#/components/schemas/portCalendar'
                  queryParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      activityCode:
                        $ref: './oiapComponents.yml#/components/schemas/activity'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  

  /targetPeriode:
    get:
      tags:
        - Port Calendar
      summary: Returns a list of working days and openning hours. # Pending
      description: >
              Information about working days, weekend days, and list of public holidays from the requested date period and port.
              Possible APIs:
              **Port calendar**: Query about the companies that will work on a specific period of time.
              Request parameters: port name, port UN/LOCODE, name of the company, activity, selected period of time.
              Data included in the response: json with the name of the company, day of the selected period, opening hours on that day.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/activity'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  targetPeriode:
                    type: array
                    items:
                      $ref: '#/components/schemas/targetPeriode'
                  queryParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      activityCode:
                        $ref: './oiapComponents.yml#/components/schemas/activity'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  

  /isWorkingDay:
    get:
      tags:
        - Port Calendar
      summary: Returns a boolean indicating if a requested periode is a working day for a company or a governmental body.
      description: >
              Answer to the question that if a specific day working day for a company or a governmental body. 
              Information about working days, weekend days, and list of public holidays from the requested date period and port.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/activity'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  isWorkingDay:
                    type: array
                    items:
                      $ref: '#/components/schemas/isWorkingDay'
                  queryParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      activityCode:
                        $ref: './oiapComponents.yml#/components/schemas/activity'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  
# End of not used

components:
  parameters: 

    country:
      in: query
      name: country
      description: ISO3166 2 characters country code.        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/countryCode'

    subdivision:
      in: query
      name: subdivision
      description: ubdivision code from ISO 3166 â€” Codes for the representation of names of countries and their subdivisions.         
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/subdivisionCode'

    fromDate:
      in: query
      name: fromDate
      description: First day of a period, expressed as YYYY-MM-DD.        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/fromDate'

    toDate:
      in: query
      name: toDate
      description: Last day of a period, expressed as YYYY-MM-DD.        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/toDate'




# Still not used
    portCode:
      in: query
      name: portCode
      description: |
            Port UN/LOCODE
            Default value is Locode of Port what provides the services
            example: portCode=ESBCN        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/portCode'

    activity:
      in: query
      name: Activity
      description: |
            tbd      
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/activity'
# End of not used

  schemas:
    holiday:
      description: 'A day on which normal activities, especially business or work including school, are suspended or reduced.'
      type: object
      allOf:
        - type: object 
          properties:
            holidayDate:  
              $ref: './oiapComponents.yml#/components/schemas/holidayDate'
            holidayType: 
              $ref: './oiapComponents.yml#/components/schemas/holidayType'
            holidayCountry:
              $ref: './oiapComponents.yml#/components/schemas/countryCode'
            holidaySubdivision:
              $ref: './oiapComponents.yml#/components/schemas/subdivisionCode'
      required:
        - holidayDate

# Still not used
    portCalendar: 
      description: ' '
      type: object
      allOf:
        - type: object 
          properties:
            startDate:  
              $ref: './oiapComponents.yml#/components/schemas/fromDate' 
      required:
        - startDate 
    targetPeriode: 
      description: 'Target periode.'
      type: object
      allOf:
        - type: object 
          properties:
            startDate:  
              $ref: './oiapComponents.yml#/components/schemas/fromDate'
            dateRange:
              $ref: './oiapComponents.yml#/components/schemas/toDate'
      required:
        - startDate
        - dateRange 

    isWorkingDay: 
      description: 'Boolean indicating that is a working day or not.'
      type: boolean
      enum: [Yes, Not]
      example: Yes
# End of not used