openapi: '3.0.3'
info:
  version: '0.9.0-oas3'
  title: OIAP
  description: |
    **Open Info API para Puertos**


    This file contains all the APIs developed for the `Open Info API para Puertos` project for the **Port Procedures Domain** within the initiative Ports 4.0 form Puertos del Estado (ES). 

  termsOfService: http://swagger.io/terms/
  license:
    name: CC0 1.0 Universal (CC0 1.0)
    url: https://creativecommons.org/publicdomain/zero/1.0/deed.es
  contact:
    name: OpenInfoAPI github
    url: https://github.com/portdebarcelona/OpenInfoAPI-Ports
tags:
  - name: Port Procedures
    description: "APIs related to the docummentary procedures of a port."
    externalDocs:
      description: Description 
      url: http://swagger.io/ 
servers:
  - url: https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/oasdefinitions
    description: Servidor server 

paths:
  /customsClearanceProcedure:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the procedures for clearing the goods in import can be found.
      description: Returns a list of resources where the procedures for clearing the goods in import can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  customsClearanceProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/customsClearanceProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  

  /borderInspectionProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the procedures for clearing the goods subject to controls from the border inspection services can be found.
      description: Returns a list of resources where the procedures for clearing the goods subject to controls from the border inspection services can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/borderInspectionProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

  /vgmProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the verified gross mass (VGM) procedures can be found.
      description: Returns a list of resources where the verified gross mass (VGM) procedures can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  vgmProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/vgmProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

  /containerTareWeight:
    get:
      tags:
        - Port Procedures
      summary: Returns the tare weight of a given container.
      description: Returns the tare weight of a given container.
      parameters:
        - $ref: '#/components/parameters/containerNumber'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  containerTare:
                    type: array
                    items:
                      $ref: '#/components/schemas/containerTare'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/containerNumber'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  
  /qualityCertificationProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the quality certification procedures from a port can be found.
      description: Returns a list of resources where the quality certification procedures from a port can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  vgmProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/qualityCertificationProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

  /qualityCertifiedPartners:
    get:
      tags:
        - Port Procedures
      summary: List of companies that have been certified by the quality seal managers of a port.
      description: List of companies that have been certified by the quality seal managers of a port. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionActors:
                    type: array
                    items:
                      $ref: '#/components/schemas/qualityCertifiedPartner'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'

  /partnerActivities:
    get:
      tags:
        - Port Procedures
      summary: List of possible activities of a partner.
      description: List of possible activities of a partner. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionActors:
                    type: array
                    items:
                      $ref: '#/components/schemas/partnerActivity'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'

  /pickupDeliveryProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the procedures for for pick-up or delivery containers from/to the terminal or depot can be found.
      description: Returns a list of resources where the procedures for for pick-up or delivery containers from/to the terminal or depot can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/pickupDeliveryProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

  /approachInstructions:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where basic information for the approach of the vessels to a port can be found.
      description: Returns a list of resources where basic information for the approach of the vessels to a port can be found.
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/approachInstructions'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

components:
  parameters: 
    portCode:
      in: query
      name: portCode
      description: |
            Port UN/LOCODE
            Default value is Locode of Port what provides the services
            example: portCode=ESBCN        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/portCode'

    containerNumber:
      in: query
      name: containerNumber
      description: |
            Container number as is described in ISO6346
            example: ABCU1234567        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/containerNumber'

  schemas:
    customsClearanceProcedure: 
      description: 'URI where a customs clearance procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            customsClearanceDescription:  
              description: 'Procedure description'
              type: string
              enum: ['All shipments of goods entering the European Union from third countries are subject to Customs controls. All goods may be subject to the presentation of several documents and payments, as the payment of Customs duties based on the content of the shipment, payment of national taxes (VAT) or local taxes where applicable, payment of special taxes on tobacco, alcohol, etc., the cost of processing of Single Administrative Document (SAD) for imports, the costs arising from border safety controls, depending on the nature of the shipment (sanitary, pharmaceutical, veterinary, etc.). As a part of the customs clearance process, customs can carry out docummentary or physical inspections, and those can be carried out inside the cargo terminals, at the terminal yard or in a warehouse, but they can also inspect containers, platforms or trucks using a non-intrusive technology as an X-ray scanner. It is the recipient''s responsibility to know the conditions for importing their shipment (prohibitions, restrictions, limitations, etc.) and to find out what documents may be required on arrival, including the commercial invoice, certificate of origin, licences and special authorisations for border controls, etc.'] 
            customsClearanceUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - customsClearanceUri 

    borderInspectionProcedure: 
      description: 'URI where a border inspection procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            borderInspectionDescription:  
              description: 'Procedure description'
              type: string
              enum: ['The border inspection post (BIP) is a controlled and authorised station for customs and sanitary controls of goods. Physical and documentary inspections are carried out at these posts as well as analysis of samples. A Border Control Post is an inspection post designated and approved in line with EU legislation for carrying out checks on animals and animal products arriving from third countries at a European Union border. These checks are carried out to protect animal and public health, and animal welfare. As a part of the border clearance process, border inspection services can carry out docummentary or physical inspections, and those can be carried out inside the cargo terminals but usually the physical inspections are carried out at the Border Inspection Posts (BIP), where coexist several specific inspection areas as a designated point of import (DPI), a designated point of entry (DPE) or a border control post (BCP). It is the recipient''s responsibility to know the conditions for importing their shipment (prohibitions, restrictions, limitations, etc.) and to find out what documents may be required on arrival, including the commercial invoice, certificate of origin, licences and special certifications for border controls, etc.'] 
            borderInspectionUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - borderInsp√®ctionUri 

    vgmProcedure: 
      description: 'URI where a VGM procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            vgmProcedureDescription:  
              description: 'Procedure description'
              type: string
              enum: ['As the International Maritime Organisation (IMO) declare: *"discrepancies between the declared gross mass and the actual gross mass of a packed container could have an adverse impact on the safety of the ship, seafarers and shore-side workers, by leading to incorrect vessel stowage decisions and potentially collapsed container stacks or loss of containers overboard"*. The IMO established a requirement that packed containers must be weighed to obtain their actual gross mass prior to vessel loading.  This requirement is included in the Guidelines regarding the verified gross mass of a container carrying cargo (MSC.1/Circ.1475) and the adoption of amendment to SOLAS regulation VI/2 requires the mandatory verification of the gross mass of packed containers (resolution MSC.380(94)). The aforementioned SOLAS amendments introduce two main new requirements:  1. the shipper is responsible for providing the verified weight by stating it in the shipping document and submitting it to the master or his representative and to the terminal representative sufficiently in advance to be used in the preparation of the ship stowage plan; and  2. the verified gross mass is a condition for loading a packed container onto a ship. A prerequisite for the container to be loaded onto a ship to which the SOLAS regulations apply is the availability of the verified gross mass of a packed container sufficiently in advance to the terminal representative and to the master or his representative to be used in the ship stowage plan.  However, it does not constitute an entitlement for loading, because the master retains ultimate discretion in deciding whether to accept a packed container for loading onto his ship. The verification of the gross mass can be achieved by either of two methods: 1. weighing the packed container; or 2. weighing all packages and cargo items, including the mass of pallets, dunnage and other securing material to be packed in the container and adding the tare mass of the container to the sum of the single masses, using a certified method approved by the competent authority of the State in which packing of the container was completed.'] 
            vgmProcedureUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - vgmProcedureUri 

    containerTare: 
      description: 'URI where a VGM procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            containerNumber:  
              $ref: './oiapComponents.yml#/components/schemas/containerNumber' 
            equipmentTare:  
              $ref: './oiapComponents.yml#/components/schemas/equipmentTare' 
            iso6346:  
              $ref: './oiapComponents.yml#/components/schemas/iso6346'
      required:
        - equipmentTare 

    qualityCertificationProcedure: 
      description: 'URI where the quality certification procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            qualityCertificationDescription:  
              description: 'Procedure description'
              type: string
              enum: ['Several ports have developed own brands for their quality label schemas. There are some ports that every day manage the transportation of thousands of shipments. And the job of each port is to treat each one as it was the only one. To ensure that each shipment receives the treatment it deserves, some ports have created a quality brand that identifies the companies operating at that port that had adopted a commitment to efficiency the end customers with the utmost satisfaction. With this quality level the ports recognise and certify organisations involved and commited to the most rigorous standards of reliability.'] 
            qualityCertificationUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - vgmProcedureUri 

    qualityCertifiedPartner:
      description: 'Information about companies and governmental bobies that have been certified with the quality level of a port.'
      type: object
      oneOf:
        - type: object 
          properties:
            companyDetails:  
              $ref: './oiapComponents.yml#/components/schemas/companyDetails' 
            governmentalBodyDetails: 
              $ref: './oiapComponents.yml#/components/schemas/governmentalBodyDetails'

    partnerActivity:
      description: 'Information about companies and governmental bobies that have been certified with the quality level of a port.'
      type: object
      $ref: './oiapComponents.yml#/components/schemas/partnerActivity'

    pickupDeliveryProcedure: # Pendent !!!!
      description: 'Information about companies and governmental bobies that have been certified with the quality level of a port.'
      type: object
      $ref: './oiapComponents.yml#/components/schemas/partnerActivity'

    approachInstructions: # Pendent !!!!
      description: 'Basic information for the approach of the vessels to a port.'
      type: object
      allOf:
        - type: object 
          properties:
            portName: 
              $ref: './oiapComponents.yml#/components/schemas/portName'
            entrances: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
            approachChannels: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            precautionaryAreas: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            portTraffic: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'              
            emergency: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            specialOperations: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            pilotage: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            tugs: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            linesmen: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            lastChanges: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
      required: # nota
        - portName