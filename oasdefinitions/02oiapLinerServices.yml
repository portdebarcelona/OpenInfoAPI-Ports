openapi: '3.0.3'
info:
  version: '0.9.0-oas3'
  title: OIAP
  description: |
    **Open Info API para Puertos**


    This file contains all the APIs developed for the `Open Info API para Puertos` project for the **Liner Services Domain** within the initiative Ports 4.0 form Puertos del Estado (ES). 

  termsOfService: http://swagger.io/terms/
  license:
    name: CC0 1.0 Universal (CC0 1.0)
    url: https://creativecommons.org/publicdomain/zero/1.0/deed.es
  contact:
    name: OpenInfoAPI github
    url: https://github.com/portdebarcelona/OpenInfoAPI-Ports
tags:
  - name: Liner Services
    description: "APIs related to the Liner Services that are scheduled in a port."
    externalDocs:
      description: Description 
      url: http://swagger.io/ 
servers:
  - url: https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/oasdefinitions
    description: Servidor server 

paths:
  /linerServices:
    get:
      tags:
        - Liner Services
      summary: Returns a list of liner services of a port.
      description: Returns a list of liner services of a port. 
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/linkedPortCode'
        - $ref: '#/components/parameters/coastalArea'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  linerServices:
                    type: array
                    items:
                      $ref: '#/components/schemas/linerService'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      linkedPortCode:
                        $ref: './oiapComponents.yml#/components/schemas/linkedPortCode'
                      coastalArea:
                        $ref: './oiapComponents.yml#/components/schemas/coastalArea'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  

  /linkedPorts:
    get:
      tags:
        - Liner Services
      summary: Returns the list of linked ports served by liner services from a port. 
      description: >-
        This GET API returns the list of linked ports served by liner services from a port. 
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/coastalArea'
        - $ref: '#/components/parameters/countryCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  linkedPorts:
                    type: array
                    items:
                      $ref: './oiapComponents.yml#/components/schemas/linkedPort'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      coastalArea:
                        $ref: './oiapComponents.yml#/components/schemas/coastalArea'                        
                      countryCode:
                        $ref: './oiapComponents.yml#/components/schemas/countryCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

  /linerCarriers: 
    get:
      tags:
        - Liner Services
      summary: List of the carriers that serve a port, a maritime coastal area or a country.
      description: List of the carriers that serve a port, a maritime coastal area or a country.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/coastalArea'        
        - $ref: '#/components/parameters/countryCode'
        - $ref: '#/components/parameters/linkedPortCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  linerCarriers:
                    type: array
                    items:
                      $ref: './oiapComponents.yml#/components/schemas/linerCarrier'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      coastalArea:
                        $ref: './oiapComponents.yml#/components/schemas/coastalArea'
                      countryCode:
                        $ref: './oiapComponents.yml#/components/schemas/countryCode'
                      linkedPortCode:
                        $ref: './oiapComponents.yml#/components/schemas/linkedPortCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'

components:
  parameters: 
    portCode:
      in: query
      name: portCode
      description: |
            Port UN/LOCODE
            Default value is Locode of Port what provides the services
            example: portCode=ESBCN        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/portCode'

    coastalArea:  
      in: query
      name: coastalArea
      description: 
            MARITIME COASTAL AREAS 
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/coastalArea'

    countryCode:  
      in: query
      name: countryCode
      description: 
            Country code as in ISO3166 2 alpha characters. 
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/countryCode'

    linkedPortCode:  
      in: query
      name: linkedPortCode
      description: 
            Port that is served by a direct service of a liner and do not requires a transshipment.
      required: false
      style: form
      explode: false
      example: HKHKG
      schema:
        $ref: './oiapComponents.yml#/components/schemas/linkedPort'

    linerServiceName:  
      in: query
      name: fromDate
      description: 
            The name of a Liner Service as it is in Alphaliner.
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/linerServiceName'

  schemas:
    linerService: 
      description: 'List of attributes that describe a liner service.'
      type: object
      allOf:
        - type: object
          properties:
            linerServiceName:  
              $ref: './oiapComponents.yml#/components/schemas/linerServiceName' 
            linerServiceCode: 
              $ref: './oiapComponents.yml#/components/schemas/linerServiceCode'
            linerCarriers: 
              $ref: '#/components/schemas/linerCarriers'        
            linkedPorts:  
              $ref: '#/components/schemas/linkedPorts'
            coveredGeographicalAreas:  
              $ref: '#/components/schemas/coveredGeographicalAreas' 
            linerServiceType:  
              $ref: './oiapComponents.yml#/components/schemas/linerServiceType'
            linerServiceCapacity:  
              $ref: './oiapComponents.yml#/components/schemas/linerServiceCapacity'
            linerSailingFrequency:  
              $ref: './oiapComponents.yml#/components/schemas/linerSailingFrequency' 
            linerDurationOfRotation:  
              $ref: './oiapComponents.yml#/components/schemas/linerDurationOfRotation'
      required:
        - linerServiceName
        - linerCarriers
        - coveredGeographicalAreas  
        - linerServiceType
        - linerSailingFrequency  

    linerCarriers:
      description: 'Carriers that operate in a liner service.'
      type: array
      items:
        $ref: './oiapComponents.yml#/components/schemas/linerCarrier'

    linerSlots: 
      description: 'Shipping lines that have slots of a liner service.'
      type: array
      items:
        $ref: './oiapComponents.yml#/components/schemas/linerSlot'

    linkedPorts: 
      description: 'Ports that are served by a liner service.'
      type: array
      items:
        $ref: './oiapComponents.yml#/components/schemas/linkedPort'

    coveredGeographicalAreas:
      description: 'Geographical area covered by a liner service.'
      type: array
      items:
        $ref: './oiapComponents.yml#/components/schemas/coastalArea' 


