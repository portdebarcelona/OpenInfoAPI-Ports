openapi: '3.0.3'
info:
  version: '0.9.0-oas3'
  title: OIAP
  description: |
    **Open Info API para Puertos**


    This file contains all the APIs developed for the `Open Info API para Puertos` project for the **Port Procedures Domain** within the initiative Ports 4.0 form Puertos del Estado (ES). 

  termsOfService: http://swagger.io/terms/
  license:
    name: CC0 1.0 Universal (CC0 1.0)
    url: https://creativecommons.org/publicdomain/zero/1.0/deed.es
  contact:
    name: OpenInfoAPI github
    url: https://github.com/portdebarcelona/OpenInfoAPI-Ports
tags:
  - name: Port Procedures
    description: "APIs related to the docummentary procedures of a port."
    externalDocs:
      description: Description 
      url: http://swagger.io/ # https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/docs/CatalogIntroduction.md It must be a link to a GitHub file with a more extensive description like Port Procedures are those served by liner ships that regularly sails on a fixed route following a schedule. A shipping schedule can be checked by vessel, by port of call, or by routing. 
servers:
  - url: https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/oasdefinitions
    description: Servidor server 
# Canvi efectuat: 'https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/oasdefinitions a '.

paths:
  /customsClearanceProcedure:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the procedures for clearing the goods in import can be found.
      description: Returns a list of resources where the procedures for clearing the goods in import can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  customsClearanceProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/customsClearanceProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  
  /customsClearanceActors:
    get:
      tags:
        - Port Procedures
      summary: Contact information of the different actors involved in the customs clearance process.
      description: Contact information of the different actors involved in the customs clearance process. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  customsClearanceActors:
                    type: array
                    items:
                      $ref: '#/components/schemas/customsClearanceActor'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  
  /borderInspectionProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the procedures for clearing the goods subject to controls from the border inspection services can be found.
      description: Returns a list of resources where the procedures for clearing the goods subject to controls from the border inspection services can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/borderInspectionProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  /borderInspectionActors:
    get:
      tags:
        - Port Procedures
      summary: Contact information of the different actors involved in the customs clearance process.
      description: Contact information of the different actors involved in the customs clearance process. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionActors:
                    type: array
                    items:
                      $ref: '#/components/schemas/borderInspectionActor'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  /vgmProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the verified gross mass (VGM) procedures can be found.
      description: Returns a list of resources where the verified gross mass (VGM) procedures can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  vgmProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/vgmProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  /containerTareWeight:
    get:
      tags:
        - Port Procedures
      summary: Returns the tare weight of a given container.
      description: Returns the tare weight of a given container.
      parameters:
        - $ref: '#/components/parameters/containerNumber'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  containerTare:
                    type: array
                    items:
                      $ref: '#/components/schemas/containerTare'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/containerNumber'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  /qualityCertificationProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the quality certification procedures from a port can be found.
      description: Returns a list of resources where the quality certification procedures from a port can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  vgmProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/qualityCertificationProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  /qualityCertifiedPartners:
    get:
      tags:
        - Port Procedures
      summary: List of companies that have been certified by the quality seal managers of a port.
      description: List of companies that have been certified by the quality seal managers of a port. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionActors:
                    type: array
                    items:
                      $ref: '#/components/schemas/qualityCertifiedPartner'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'
  /partnerActivities:
    get:
      tags:
        - Port Procedures
      summary: List of possible activities of a partner.
      description: List of possible activities of a partner. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionActors:
                    type: array
                    items:
                      $ref: '#/components/schemas/partnerActivity'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'
  /pickupDeliveryProcedures:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where the procedures for for pick-up or delivery containers from/to the terminal or depot can be found.
      description: Returns a list of resources where the procedures for for pick-up or delivery containers from/to the terminal or depot can be found. 
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/pickupDeliveryProcedure'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
  /approachInstructions:
    get:
      tags:
        - Port Procedures
      summary: Returns a list of resources where basic information for the approach of the vessels to a port can be found.
      description: Returns a list of resources where basic information for the approach of the vessels to a port can be found.
      parameters:
        - $ref: '#/components/parameters/portCode'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  borderInspectionProcedures:
                    type: array
                    items:
                      $ref: '#/components/schemas/approachInstructions'
                  requestedParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

components:
  parameters: 
    portCode:
      in: query
      name: portCode
      description: |
            Port UN/LOCODE
            Default value is Locode of Port what provides the services
            example: portCode=ESBCN        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/portCode'
    containerNumber:
      in: query
      name: containerNumber
      description: |
            Container number as is described in ISO6346
            example: ABCU1234567        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/containerNumber'

  schemas:
    customsClearanceProcedure: 
      description: 'URI where a customs clearance procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            customsClearanceUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - customsClearanceUri 
    customsClearanceActor: 
      description: 'Contact information of an actor involved in the customs clearance process.'
      type: object
      anyOf:
        - type: object 
          properties:
            companyDetails:  
              $ref: './oiapComponents.yml#/components/schemas/companyDetails' 
            governmentalBodyDetails: 
              $ref: './oiapComponents.yml#/components/schemas/governmentalBodyDetails'
    borderInspectionProcedure: 
      description: 'URI where a border inspection procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            borderInspectionUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - borderInspèctionUri 
    borderInspectionActor:
      description: 'Contact information of an actor involved in the border inspection services clearance process.'
      type: object
      anyOf:
        - type: object 
          properties:
            companyDetails:  
              $ref: './oiapComponents.yml#/components/schemas/companyDetails' 
            governmentalBodyDetails: 
              $ref: './oiapComponents.yml#/components/schemas/governmentalBodyDetails'
    vgmProcedure: 
      description: 'URI where a VGM procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            vgmProcedureUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - vgmProcedureUri 
    containerTare: # Pendent de definir
      description: 'URI where a VGM procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            containerNumber:  
              $ref: './oiapComponents.yml#/components/schemas/containerNumber' 
            equipmentTare:  
              $ref: './oiapComponents.yml#/components/schemas/equipmentTare' 
            iso6346:  
              $ref: './oiapComponents.yml#/components/schemas/iso6346'
      required:
        - equipmentTare 
    qualityCertificationProcedure: 
      description: 'URI where the quality certification procedure from a port can be found.'
      type: object
      allOf:
        - type: object 
          properties:
            qualityCertificationUri:  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
      required:
        - vgmProcedureUri 
    qualityCertifiedPartner:
      description: 'Information about companies and governmental bobies that have been certified with the quality level of a port.'
      type: object
      anyOf:
        - type: object 
          properties:
            companyDetails:  
              $ref: './oiapComponents.yml#/components/schemas/companyDetails' 
            governmentalBodyDetails: 
              $ref: './oiapComponents.yml#/components/schemas/governmentalBodyDetails'
    partnerActivity:
      description: 'Information about companies and governmental bobies that have been certified with the quality level of a port.'
      type: object
      $ref: './oiapComponents.yml#/components/schemas/partnerActivity'
    pickupDeliveryProcedure: # Pendent !!!!
      description: 'Information about companies and governmental bobies that have been certified with the quality level of a port.'
      type: object
      $ref: './oiapComponents.yml#/components/schemas/partnerActivity'
    approachInstructions: # Pendent !!!!
      description: 'Basic information for the approach of the vessels to a port.'
      type: object
      allOf:
        - type: object 
          properties:
            portName: 
              $ref: './oiapComponents.yml#/components/schemas/portName'
            entrances: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri' 
            approachChannels: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            precautionaryAreas: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            portTraffic: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'              
            emergency: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            specialOperations: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            pilotage: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            tugs: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            linesmen: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
            lastChanges: #array  
              $ref: './oiapComponents.yml#/components/schemas/uri'
      required:
        - portName