openapi: '3.0.3'
info:
  version: '0.9.0-oas3'
  title: OIAP
  description: >
        **Open Info API para Puertos**


        This file contains all the APIs developed for the `Open Info API para Puertos` project for the **Terminal Performance Domain** within the initiative Ports 4.0 form Puertos del Estado (ES).


        This domain will include some operational data related to the performance of the terminals, like their actual access time or some other figures like their dayly or hourly gate movements, at the land side, or information about their movements per hour at the sea side of the terminal.

  termsOfService: http://swagger.io/terms/
  license:
    name: CC0 1.0 Universal (CC0 1.0)
    url: https://creativecommons.org/publicdomain/zero/1.0/deed.es
  contact:
    name: OpenInfoAPI github
    url: https://github.com/portdebarcelona/OpenInfoAPI-Ports
tags:
  - name: Terminal Performance
    description: "APIs related to the the terminal performance of a port."
    externalDocs:
      description: Description 
      url: http://swagger.io/ # https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/docs/CatalogIntroduction.md It must be a link to a GitHub file with a more extensive description like Terminals are those served by liner ships that regularly sails on a fixed route following a schedule. A shipping schedule can be checked by vessel, by port of call, or by routing. 
servers:
  - url: https://raw.githubusercontent.com/portdebarcelona/OpenInfoAPI-Ports/develop/oasdefinitions
    description: Main server 

paths:
  /accessWaitTime:
    get:
      tags:
        - Terminal Performance
      summary: Estimated waiting time that trucks have to queue before they can enter into a terminal.
      description: Returns a list with the estimated waiting time that trucks have to queue before they can enter into a terminal.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/terminal'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  accessTime:
                    type: array
                    items:
                      $ref: '#/components/schemas/accessTime'
                  metadata: 
                    $ref: './oiapComponents.yml#/components/schemas/metadata'
                  queryParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      terminalCode:
                        $ref: './oiapComponents.yml#/components/schemas/terminalCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error'  

  /landsideThroughput:
    get:
      tags:
        - Terminal Performance
      summary: Number of units (containers, freight cars,...) that enter or leave a terminal per hour during the present day.
      description: Returns a list with the number of units (containers, freight cars,...) that enter or leave a terminal per hour during the present day.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/terminal'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  accessTime:
                    type: array
                    items:
                      $ref: '#/components/schemas/throughput'
                  metadata: 
                    $ref: './oiapComponents.yml#/components/schemas/metadata'
                  queryParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      terminalCode:
                        $ref: './oiapComponents.yml#/components/schemas/terminalCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 

  /seasideThroughput:
    get:
      tags:
        - Terminal Performance
      summary: Returns the number of containers loaded or unloaded from vessels on a terminal per hour and during the present day.
      description: eturns the number of containers loaded or unloaded from vessels on a terminal per hour and during the present day.
      parameters:
        - $ref: '#/components/parameters/portCode'
        - $ref: '#/components/parameters/terminal'
      responses: #status code
        '200':
          description: Successful operation
          headers:
            oiapApiVersion:
              $ref: './oiapComponents.yml#/components/headers/oiapApiVersion'
          content: 
            application/json:
              schema:
                type: object
                properties:
                  accessTime:
                    type: array
                    items:
                      $ref: '#/components/schemas/throughput'
                  metadata: 
                    $ref: './oiapComponents.yml#/components/schemas/metadata'
                  queryParams:
                    type: object
                    properties:
                      portCode:
                        $ref: './oiapComponents.yml#/components/schemas/portCode'
                      terminalCode:
                        $ref: './oiapComponents.yml#/components/schemas/terminalCode'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: './oiapComponents.yml#/components/schemas/error' 
 
components:
  parameters: 
    portCode:
      in: query
      name: portCode
      description: |
            Port UN/LOCODE
            Default value is Locode of Port what provides the services
            example: portCode=ESBCN        
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/portCode'

    terminal:
      in: query
      name: terminal
      description: Code that identifies a terminal.       
      required: false
      style: form
      explode: false
      schema:
        $ref: './oiapComponents.yml#/components/schemas/terminalCode'

  schemas:
    accessTime: 
      description: 'Estimated period of time, in minites, that trucks have to queue before they can enter into a terminal.'
      type: object
      allOf:
        - type: object 
          properties:
            terminalCode:  
              $ref: './oiapComponents.yml#/components/schemas/terminalCode' 
            waitTime:
              $ref: './oiapComponents.yml#/components/schemas/waitTime'
      required:
        - terminalCode 

    throughput: 
      description: 'Flow of goods or equipment units, expressed as movements per hour.'
      type: object
      allOf:
        - type: object 
          properties:
            terminalCode:  
              $ref: './oiapComponents.yml#/components/schemas/terminalCode' 
            flowDirection:  
              $ref: './oiapComponents.yml#/components/schemas/flowDirection'
            hourReported:
              $ref: './oiapComponents.yml#/components/schemas/hour'             
            throughput:
              $ref: './oiapComponents.yml#/components/schemas/throughput'
      required:
        - terminalCode 




